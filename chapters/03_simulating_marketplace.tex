\begin{jointwork}
	In this section we will outline the requirements and challenges of transferring the vast amount of features and parameters that influence vendor and customer decisions in real recommerce markets to our simulated market environment. We will take a brief look at different market scenarios as well as how our customers work, with a focus on the unique feauture of recommerce markets; the buyback of used items by the vendors. The focus of this chapter will however lie on the vendors, the rule based as well as the ones trained using Reinforcement Learning, comparing their features and how they fare against each other. These comparisons will be done using our various monitoring tools, which will be explained in the following chapter, \nameref{ch:Approaches}. While results of these experiments will be shortly touched upon, we will go into further detail in the closing chapter, \nameref{ch:InterpretResults}.
\end{jointwork}

\section{Market scenarios} \label{sec:MarketScenarios}

In our framework, we implemented a number of "market blueprints" both for classic Linear Economy markets, as well as for Circular Economy markets both with and without rebuy-prices enabled. There are marketplaces available for each combination of the following two features:
\begin{enumerate}
    \item Marketplace type: Linear Economy, Circular Economy, Circular Economy with rebuy-prices
	\item Market environment: Monopoly, Duopoly, Oligopoly
\end{enumerate}
The marketplace type defines the number of prices the vendor has to set. In a Linear Economy, vendors only set prices for new items, in a Circular Economy prices for refurbished items need to be set as well. In order to simulate a recommerce market, the user can choose a Circular Economy with rebuy-prices.
The market environment defines the number of competing vendors in the simulation: Monopolistic and competitive markets are available, where the Duopoly is simply a particular version of an Oligopoly. Depending on the chosen market environment, one, two, or any number of vendors can be chosen to be used in the experiment.

In most usecases of our framework, only one competitor in the market needs to be configured by the user, most of the times this will be a Reinforcement Learning agent that is to be trained. For this reason, each market environment is equipped with a pre-defined set of competitors that will play against the agent defined by the user. To allow for more control over the simulation, users are however also able to customize this "competitor-list" to use any vendor they want - as long as they are a valid fit for the marketplace type. In certain situations, such as the \nameref{subsec:AgentMonitoring} tool, multiple Reinforcement Learning agents can be chosen to compete on one market.\todo{Currently, all agents perform independent from each other on their markets, so this statement is incorrect}

\section{Customers}

Customers are at the center of every type of marketplace, which makes them an integral part of our market simulation. However, since each customer in the real market is an individual with different reasonings and makes purchase decisions based upon personal preferences, modelling a realistic depiction of real-world customers proves to be very difficult and time-consuming. For this reason we decided to keep our initial implementation of the customers as simple as possible, taking into account future extension and scalability concerns. As we are focussing on dynamic pricing and therefore allow our vendors to only change the prices of their products, we decided on building customers that value price over any other features a product may have. Additionally, in Circular Economy markets, customers have preferences on whether they would like to buy new or refurbished items.

Once customers have decided to buy a product from any of the available vendors, they turn into an \emph{owner}. In the next step of the simulation, they are offered the option of selling their now used product back to one of the vendors. If they decide to do so, the vendor pays them the advertised \emph{re-buy price} and adds the used product to their inventory, from where it can then be sold as a refurbished procuct in the next step.

\section{Vendors} \label{sec:ExplainVendors}

Vendors are the main focus of our market simulation.

While our framework will not be able to reproduce all types of pricing models used in the real market, we strive to model as many different models as possible (and feasable in the scope of the project). We will use the following four types of dynamic pricing models, as described in "Dynamic pricing models for electronic business" \cite{dynamicPricingModels}, to group our different approaches and see how each type performs in the context of our simulation framework:

\begin{enumerate}
	\item \emph{Inventory-based models}: These are pricing models which are based on inventory levels and similar parameters, such as the number of items in circulation. In our framework, almost all rule-based agents consider their inventory levels when deciding which prices to set. The only exception to this rule are the simplest of our agents, the \emph{FixedPriceAgents}, which will always set the same prices, no matter the current market state and competitor actions. We chose to implement this rather incompetent type of agent, as there are still many vendors in the real market which do not make use of dynamic pricing models, but use static pricing methods like these \emph{FixedPriceAgents} instead. Not including these in our framework would therefore remove a fraction of realism.

	Inventory-based models are comparatively easy to implement, as they only depend on data immediately available to the vendor. This has the advantage that rule based agents based on this technique are relatively simple to create and modify. Examples of \emph{Inventory-based agents} in our framework can be found in the \emph{RuleBasedCEAgent}, one of \emph{RuleBasedCEAgent} the first rule based agents we created. This agent does not take pricing decisions of its competitors in the market into account, but simply acts according to its own storage costs. While its performance is not necessarily bad, it is still one of the weakest competitors currently available in the framework. \todo{Compare this agent with other agents, RL, FixedPrice, better rule-based!}

	\item \emph{Data-driven models}: \emph{Data-driven} models take dynamic pricing decisionmaking one level further. They utilize their knowledge of the market, such as customer preferences, past sales data or competitor prices, to derive optimal pricing decisions. Aside from the aforementioned \emph{FixedPriceAgents} and the basic \emph{RuleBasedCEAgent}, all of our other rule based agents fall into this category. One of the most prominent examples of a \emph{Data-driven model} is the \emph{RuleBasedCERebuyAgentStorageMinimizer}. This agent bases its prices on two major factors. First, it reacts to its competitors prices by matching its initial prices to the median price of its competitors, and then adjusts them according to current inventory. Notably, all of our \emph{Data-driven models} are also \emph{Inventory-based} to a certain extent, as handling storage plays a big part in a Circular Economy market setting, where used products need to be bought back from customers and subsequently undergo refurbishment while in inventory of the company. \emph{Data-driven models} have proven to be the most competent rule based agents in our recommerce market scenario, in particular the above described \emph{RuleBasedCERebuyAgentStorageMinimizer}, which only consists of ten lines of code but is still able to outperform seemingly more complex \emph{Inventory-based models} \todo{Graphs...}.

	\item \emph{Game theory models}: \label{bullet:GameTheory}Game theory concerns itself with the study of models for conflict and cooperation between rational, intelligent entities \cite{GameTheory}. It is therefore often applicable in situations where competing individuals, acting rationally and selfishly interact with each other. In our framework, competitors in the market are influenced in their decisionmaking processes by the actions of other participants of the scenario. While none of our rule based agents have been specifically designed to act according to game theoretic strategies, due to the fact that almost all of them consider their competitors prices in their pricing decision, and due to the nature of Reinforcement Learning trying to maximize their own profits without regard to their competitors performance, behaviour according to Game theory can sometimes be observed. \todo{Need graphs to back this claim up! Especially price-graphs, moving up and down etc.} During training, Reinforcement Learning agents observe the market state, which includes prices and sales data not only of themselves but also the other vendors in the market. Using this data, the algorithms try to predict how their prices will influence customer behaviour as well as the competing vendors. In some cases, depending on the concrete behaviour of the competitors, vendors may cooperate in driving prices higher together, in other cases the agents may act more selfishly, sacrificing own profits to stay ahead of their competitors in other regards. \todo{Graphs}

	\item \emph{Machine learning models}: All of our Reinforcement learning agents fall into the category \emph{Machine learning models}. As it is not the focus of this thesis, we will not go into detailed explanations of the various models used, but instead focus on hwo they perform in relation to each other. The algorithms used by us can be grouped together into the following three categories:
	      \begin{itemize}
		      \item Q-Learning: Q-Learning agents were the first Reinforcement Learning agents we introduced in our framework.
		      \item Actor-Critic:
		      \item Stable-Baselines:
	      \end{itemize}
\end{enumerate}


\section{Diverging from the real market}

We do not claim in any way that our simulation framework is exhaustive or complete. There are a number of parameters influencing market dynamics, small and great, which have not been modelled due to time constraints or their unpredictability in their affect on the market state or customer decisions. Seasonality of demand, customer retention and loyalty through branding and unforeseen effects on market dynamics such as global events (for example, the Covid-19 pandemic) are just some of the places where our market simulation diverges from the real market. However, all of these factors are either very rare in nature (global, unforeseen events), only applicable to a subset of markets (brand loyalty) or can initially be discarded as their effect on market dynamics is predictable, making them a lower priority than other parameters (seasonality).

Of course, this results in the fact that our framework can not be used out-of-the-box for any kind of market. However, great care was taken during the development process to build each part of the simulation in a modular way, so that new functionality can easily be integrated into it. Marketplaces, customers and vendors (rule-based as well as those using Reinforcement learning) have all been implemented as classes disconnected from each other, so that new variants of each can easily be added to the pool of available options to be used in experiments. The same goes for our monitoring tools, all of which have been built to work with any (valid) combination of input parameters.
\todo{What effect does this have on our monitoring?}